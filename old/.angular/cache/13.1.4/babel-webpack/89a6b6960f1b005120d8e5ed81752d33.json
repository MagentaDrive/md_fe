{"ast":null,"code":"\"use strict\";\n\nvar _classCallCheck = require(\"C:\\\\Users\\\\Thomas\\\\Desktop\\\\md_fe\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\classCallCheck.js\").default;\n\nvar _createClass = require(\"C:\\\\Users\\\\Thomas\\\\Desktop\\\\md_fe\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\createClass.js\").default;\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function get() {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) {\n    if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  }\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.LoginComponent = void 0;\n\nvar forms_1 = require(\"@angular/forms\");\n\nvar i0 = __importStar(require(\"@angular/core\"));\n\nvar i1 = __importStar(require(\"../_services/auth.service\"));\n\nvar i2 = __importStar(require(\"../_services/token-storage.service\"));\n\nvar i3 = __importStar(require(\"@angular/router\"));\n\nvar i4 = __importStar(require(\"@angular/forms\"));\n\nvar i5 = __importStar(require(\"../../directives/text-value-accessor\"));\n\nvar i6 = __importStar(require(\"@angular/common\"));\n\nfunction LoginComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \" Login erfolgreich \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction LoginComponent_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.errorMessage, \" \");\n  }\n}\n\nvar LoginComponent = /*#__PURE__*/function () {\n  function LoginComponent(authService, tokenStorage, router) {\n    _classCallCheck(this, LoginComponent);\n\n    this.authService = authService;\n    this.tokenStorage = tokenStorage;\n    this.router = router;\n    this.isLoggedIn = false;\n    this.isLoginFailed = false;\n    this.roles = [];\n    this.password = new forms_1.FormControl('', [forms_1.Validators.required, forms_1.Validators.minLength(8)]);\n    this.email = new forms_1.FormControl('', [forms_1.Validators.required, forms_1.Validators.email]);\n  }\n\n  _createClass(LoginComponent, [{\n    key: \"ngOnInit\",\n    value: function ngOnInit() {\n      if (this.tokenStorage.getToken()) {\n        this.roles = this.tokenStorage.getUser().roles;\n      }\n    }\n  }, {\n    key: \"setPasswordEvent\",\n    value: function setPasswordEvent(event) {\n      this.password.setValue(event.target.value);\n    }\n  }, {\n    key: \"setEmailEvent\",\n    value: function setEmailEvent(event) {\n      this.email.setValue(event.target.value);\n    }\n  }, {\n    key: \"onSubmit\",\n    value: function onSubmit() {\n      var _this = this;\n\n      this.errorMessage = '';\n\n      if (!this.email.valid) {\n        this.errorMessage = \"Es muss eine gültige E-mail sein\";\n        return;\n      }\n\n      if (!this.password.valid) {\n        this.errorMessage = \"Passwort muss mind. 8 Zeichen lang sein\";\n        return;\n      }\n\n      this.authService.login(this.email.value, this.password.value).subscribe(function (data) {\n        _this.tokenStorage.saveToken(data.accessToken);\n\n        _this.tokenStorage.saveUser(data);\n\n        _this.tokenStorage.saveUserInformation(data);\n\n        _this.isLoginFailed = false;\n        _this.isLoggedIn = true;\n        _this.roles = _this.tokenStorage.getUser().roles;\n\n        _this.reloadPage();\n      }, function (err) {\n        _this.errorMessage = err.error.message;\n        _this.isLoginFailed = true;\n      });\n    }\n  }, {\n    key: \"reloadPage\",\n    value: function reloadPage() {\n      window.location.reload();\n    }\n  }]);\n\n  return LoginComponent;\n}();\n\nexports.LoginComponent = LoginComponent;\n\nLoginComponent.ɵfac = function LoginComponent_Factory(t) {\n  return new (t || LoginComponent)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.TokenStorageService), i0.ɵɵdirectiveInject(i3.Router));\n};\n\nLoginComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: LoginComponent,\n  selectors: [[\"app-login\"]],\n  decls: 16,\n  vars: 2,\n  consts: [[2, \"max-width\", \"50%\", \"margin-left\", \"25%\", \"margin-top\", \"10%\"], [3, \"ngSubmit\"], [2, \"margin-top\", \"5%\"], [\"formControlName\", \"email\", \"label\", \"Email eingeben...\", 3, \"input\"], [\"formControlName\", \"password\", \"helper-text\", \"Passwort vergessen? Pech!\", \"label\", \"Passwort eingeben...\", \"type\", \"password\", 3, \"input\"], [\"type\", \"submit\", 2, \"margin-left\", \"45%\"], [4, \"ngIf\"], [\"style\", \"color: red\", 4, \"ngIf\"], [2, \"color\", \"red\"]],\n  template: function LoginComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵelementStart(1, \"scale-card\");\n      i0.ɵɵelementStart(2, \"h4\");\n      i0.ɵɵtext(3, \" Login\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(4, \"form\", 1);\n      i0.ɵɵlistener(\"ngSubmit\", function LoginComponent_Template_form_ngSubmit_4_listener() {\n        return ctx.onSubmit();\n      });\n      i0.ɵɵelementStart(5, \"p\", 2);\n      i0.ɵɵtext(6, \"Email \");\n      i0.ɵɵelementStart(7, \"scale-text-field\", 3);\n      i0.ɵɵlistener(\"input\", function LoginComponent_Template_scale_text_field_input_7_listener($event) {\n        return ctx.setEmailEvent($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(8, \"p\", 2);\n      i0.ɵɵtext(9, \"Passwort \");\n      i0.ɵɵelementStart(10, \"scale-text-field\", 4);\n      i0.ɵɵlistener(\"input\", function LoginComponent_Template_scale_text_field_input_10_listener($event) {\n        return ctx.setPasswordEvent($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(11, \"p\");\n      i0.ɵɵelementStart(12, \"scale-button\", 5);\n      i0.ɵɵtext(13, \"Login\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(14, LoginComponent_div_14_Template, 2, 0, \"div\", 6);\n      i0.ɵɵtemplate(15, LoginComponent_div_15_Template, 2, 1, \"div\", 7);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(14);\n      i0.ɵɵproperty(\"ngIf\", ctx.isLoggedIn);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.errorMessage);\n    }\n  },\n  directives: [i4.ɵNgNoValidate, i4.NgControlStatusGroup, i4.NgForm, i5.TextValueAccessorDirective, i4.NgControlStatus, i4.FormControlName, i6.NgIf],\n  styles: [\"\"]\n});","map":null,"metadata":{},"sourceType":"script"}